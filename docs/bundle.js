!function(t){"function"==typeof define&&define.amd?define(t):t()}(function(){"use strict";function t(t,e){e&&Object.keys(e).forEach(s=>{Array.isArray(e[s])?e[s].forEach(e=>{t.addEventListener(s,e)}):t.addEventListener(s,e[s])})}const e=Symbol("instance");function s(n){if(!0===n.skip)return null;const i=document.createElement(n.tag);if(n.textValue)if("object"==typeof n.textValue){const t=n.textValue;t.addSubscribers(t=>{i.textContent=t}),i.textContent=t.value}else i.textContent=n.textValue;if(n.classList&&n.classList.forEach(t=>{i.classList.add(t)}),n.attrs&&function(t,e){Object.keys(e).forEach(s=>{t.setAttribute(s,e[s])})}(i,n.attrs),n.children&&n.children.forEach(t=>{if(!t)return;if(!t.tag)return void i.appendChild(t);const e=s(Object.assign({},t,{parent:i}));e&&i.appendChild(e)}),n.listeners&&t(i,n.listeners),n.instance&&(i[e]=n.instance,n.instance.onInit()),"object"==typeof n.skip){const e=document.createComment("");return n.skip.addSubscribers(s=>{const r=n.parent?n.parent:null;s?r&&(r.replaceChild(i,e),n.instance&&n.instance.reInit(),t(i,n.listeners)):r&&(!function(t,e){e&&Object.keys(e).forEach(s=>{Array.isArray(e[s])?e[s].forEach(e=>{t.removeEventListener(s,e)}):t.removeEventListener(s,e[s])})}(i,n.listeners),n.instance&&n.instance.destroy(),r.replaceChild(e,i))}),n.skip.value?i:e}return i}function n(t,e,s){const n=new t(e,s);return n.template.instance=n,n.template}class i{constructor(){this.reactive={}}onDestroy(){}onInit(){}reInit(){Object.keys(this.reactive).forEach(t=>{this.reactive[t].reInit()}),this.onInit()}destroy(){Object.keys(this.reactive).forEach(t=>{this.reactive[t].destroy()}),this.onDestroy()}}class r{constructor(t){this._value=t,this.setterTimeout=null,this.subscribers=[],this.isDestroy=!1,this.firstState=t}get value(){return this._value}destroy(){this.setterTimeout&&cancelAnimationFrame(this.setterTimeout),this.isDestroy=!0}reInit(){this.isDestroy=!1,this.value=this.firstState}addSubscribers(t){this.isDestroy||this.subscribers.push(t)}set value(t){this.isDestroy||this._value!==t&&(this._value=t,this.subscribers.length&&(this.setterTimeout&&cancelAnimationFrame(this.setterTimeout),this.setterTimeout=requestAnimationFrame(()=>{this.subscribers.forEach(e=>{e(t)})})))}}function c(t){return new r(t)}function a(t,e,s={},n=(t=>t)){return t.map(t=>{if("function"==typeof e){const n={};return Object.keys(s).forEach(e=>{const i=s[e];n[e]="function"==typeof i?i(t):i}),e(n)}return Object.assign({},e,{textValue:e.textValue(t)})})}function o(){return n(u)}class u extends i{constructor(){super(...arguments),this.reactive={counter:c(0)},this.onClick=(()=>{this.counter.value+=1}),this.template={tag:"button",textValue:this.counter,listeners:{click:this.onClick}}}get counter(){return this.reactive.counter}}function l(t){return n(h,t)}class h extends i{constructor(t){super(),this.input=t,this.onClick=(()=>{this.counter.value+=1}),this.template={tag:"button",textValue:this.counter,listeners:{click:this.onClick}}}get counter(){return this.input.counter}}class d extends i{constructor(){var t;super(...arguments),this.reactive={show:(t=!0,new r(t))},this.onClick=(()=>{this.show.value=!this.show.value}),this.template={tag:"div",children:[{tag:"p",children:[{tag:"span",textValue:"Current value:"},{tag:"span",textValue:this.show}]},{tag:"button",listeners:{click:this.onClick},textValue:"Change state"},{tag:"div",textValue:"You will see me always"},{tag:"div",skip:this.show,textValue:"You will sometimes"}]}}get show(){return this.reactive.show}}const p=document.getElementById("counter");p.appendChild(s(o())),p.appendChild(s(o()));const f=document.getElementById("counter_input"),m=c(0);f.appendChild(s(l({counter:m}))),f.appendChild(s(l({counter:m}))),f.appendChild(s(l({counter:m}))),document.getElementById("simple_if").appendChild(s(n(d))),document.getElementById("simple_for").appendChild(s({tag:"div",children:[...a([1,2,3,4,5,6,7],{tag:"div",textValue:t=>t})]})),document.getElementById("simple_for_component").appendChild(s({tag:"div",children:[...a([1,2,3,4,5,6,7],o)]}))});
//# sourceMappingURL=bundle.js.map
